{"version":3,"file":"../ShipInterior.js","sourceRoot":"../../src","sources":["ShipInterior.coffee"],"names":[],"mappings":"AAAA,IAAA,gBAAA,EAAA,IAAA,EAAA,YAAA,EAAA,YAAA,EAAA,IAAA,EAAA;;AAAA,IAAA,GAAO,OAAA,CAAQ,QAAR;;AACP,aAAA,GAAgB,OAAA,CAAQ,YAAR,CAAqB,CAAC,KAAK,CAAC;;AAC5C,gBAAA,GAAmB,OAAA,CAAQ,YAAR,CAAqB,CAAC;;AACzC,IAAA,GAAO,OAAA,CAAQ,iBAAR;;AACP,YAAA,GAAe,OAAA,CAAQ,eAAR,CAAwB,CAAC;;AAExC,MAAM,CAAC,OAAP,GAAuB;EAAN,MAAA,aAAA,QAA2B,cAA3B;IAEf,IAAM,CAAA,CAAA;WAAN,CAAA,IACE,CAAA;aACA,IAAC,CAAA;IAFG;;IA2BN,WAAa,CAAA,CAAA;MACX,IAAO,6BAAP;QACE,IAAC,CAAA,gBAAD,GAAoB,IAAC,CAAA,IAAI,CAAC,QAAQ,CAAC,eADrC;;MAEA,IAAA,CAAA,CAAO,IAAC,CAAA,KAAK,CAAC,MAAP,GAAgB,CAAvB,CAAA;QACE,IAAC,CAAA,QAAD,CAAA,EADF;;MAEA,IAAO,mCAAP;eACE,IAAC,CAAA,IAAI,CAAC,iBAAN,GAA0B,KAD5B;;IALW;;IAQb,QAAU,CAAC,SAAD,CAAA;MACR,SAAA,GAAY,SAAA,IAAa,CAAC,IAAI,YAAY,CAAC,SAAjB,CAAA,CAAD,CAA8B,CAAC,GAA/B,CAAmC,QAAA,CAAA,CAAA,EAAA,CAAnC;aACzB,SAAS,CAAC,QAAV,CAAA,CAAoB,CAAC,OAArB,CAA6B,CAAC,IAAD,CAAA,GAAA;eAC3B,IAAC,CAAA,OAAD,CAAS,IAAT;MAD2B,CAA7B;IAFQ;;EArCK;;EACf,YAAC,CAAA,OAAD,CAAS,YAAY,CAAC,SAAtB;;EAKA,YAAC,CAAA,UAAD,CACE;IAAA,SAAA,EAAW,CAAA,CAAX;IACA,gBAAA,EACE;MAAA,MAAA,EAAQ,QAAA,CAAC,WAAD,CAAA;AACN,YAAA;QAAA,SAAA,GAAY,WAAW,CAAC,IAAZ,CAAiB,WAAjB;QACZ,wBAAG,SAAS,CAAE,WAAX,CAAuB,gBAAvB,UAAH;iBACE,SAAS,CAAC,eADZ;SAAA,MAEK,wBAAG,SAAS,CAAE,WAAX,CAAuB,SAAvB,UAAH;iBACH,SAAS,CAAC,QADP;;MAJC,CAAR;MAMA,MAAA,EAAQ,QAAA,CAAA,CAAA;QACN,IAAG,6BAAH;iBACE,IAAC,CAAA,OAAO,CAAC,QAAT,CAAkB,IAAC,CAAA,gBAAnB,EADF;;MADM;IANR,CAFF;IAWA,OAAA,EACE;MAAA,MAAA,EAAQ,QAAA,CAAA,CAAA;AACN,YAAA;QAAA,OAAA,GAAU,CAAA,CAAE,QAAQ,CAAC,aAAT,CAAuB,KAAvB,CAAF,CACR,CAAC,QADO,CACE,MADF;QAEV,OAAO,CAAC,GAAR,CAAY,CAAZ,CAAc,CAAC,eAAf,GAAiC;eACjC;MAJM;IAAR,CAZF;IAiBA,IAAA,EACE;MAAA,MAAA,EAAQ,QAAA,CAAC,GAAD,CAAA;QACN,IAAG,IAAC,CAAA,IAAJ;iBACE,IAAC,CAAA,WAAD,CAAA,EADF;;MADM;IAAR;EAlBF,CADF;;;;;;AAoCI,YAAY,CAAC,YAAnB,MAAA,UAAA,QAAqC,iBAArC;EACE,WAAa,CAAC,GAAD,CAAA;WACX,CAAC,IAAI,IAAJ,CAAS,GAAG,CAAC,CAAb,EAAe,GAAG,CAAC,CAAnB,CAAD,CAAuB,CAAC,GAAxB,CAA4B,QAAA,CAAA,CAAA;MAC1B,IAAC,CAAA,GAAD,GAAO;aACP,IAAC,CAAA,QAAD,GAAY;IAFc,CAA5B;EADW;;EAIb,YAAc,CAAC,GAAD,CAAA;WACX,IAAI,IAAI,CAAC,KAAT,CAAe,GAAG,CAAC,CAAnB,EAAqB,GAAG,CAAC,CAAzB;EADW;;EAEd,WAAa,CAAC,GAAD,CAAA;WACX,CAAC,IAAI,IAAI,CAAC,KAAT,CAAe,GAAG,CAAC,CAAnB,EAAqB,GAAG,CAAC,CAAzB,CAAD,CAA6B,CAAC,GAA9B,CAAkC,QAAA,CAAA,CAAA;aAChC,IAAC,CAAA,QAAD,CAAU,IAAI,IAAJ,CAAS,GAAG,CAAC,SAAb,CAAV;IADgC,CAAlC;EADW;;AAPf","sourcesContent":["Tile = require('./Tile')\nTileContainer = require('parallelio').tiles.TileContainer\nDefaultGenerator = require('parallelio').RoomGenerator\nDoor = require('./AutomaticDoor')\nEventEmitter = require('spark-starter').EventEmitter\n\nmodule.exports = class ShipInterior extends TileContainer\n  @include EventEmitter.prototype\n  init: ->\n    super()\n    @displayContainer\n\n  @properties\n    container: {}\n    displayContainer:\n      calcul: (invalidator) ->\n        container = invalidator.prop('container')\n        if container?.getProperty('contentDisplay')\n          container.contentDisplay\n        else if container?.getProperty('display')\n          container.display\n      change: ->\n        if @displayContainer?\n          @display.appendTo(@displayContainer)\n    display:\n      calcul: ->\n        display = $(document.createElement(\"div\"))\n          .addClass('ship')\n        display.get(0)._parallelio_obj = this\n        display\n    game:\n      change: (old)->\n        if @game \n          @setDefaults()\n\n  setDefaults: ->\n    unless @displayContainer?\n      @displayContainer = @game.mainView.contentDisplay\n    unless @tiles.length > 0\n      @generate()\n    unless @game.mainTileContainer?\n      @game.mainTileContainer = this\n      \n  generate: (generator)->\n    generator = generator || (new ShipInterior.Generator()).tap ->\n    generator.getTiles().forEach (tile)=>\n      @addTile(tile)\n\nclass ShipInterior.Generator extends DefaultGenerator\n  wallFactory: (opt) ->\n    (new Tile(opt.x,opt.y)).tap ->\n      @cls = 'wall'\n      @walkable = false\n  floorFactory: (opt) ->\n    (new Tile.Floor(opt.x,opt.y))\n  doorFactory: (opt) ->\n    (new Tile.Floor(opt.x,opt.y)).tap ->\n      @addChild new Door(opt.direction)"]}